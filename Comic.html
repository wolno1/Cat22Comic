<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Comic Reader</title>
	<style>
		:root {
			color-scheme: light dark;
			--bg:#0f0f11;
			--panel:#1c1f24;
			--accent:#ff4d6d;
			--accent-hover:#ff6b81;
			--text:#f5f5f5;
			--muted:#9aa0a6;
			--radius:10px;
			--shadow:0 4px 14px -2px rgba(0,0,0,.5);
			font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
		}
		* { box-sizing: border-box; }
		body {
			margin:0;
			background:linear-gradient(145deg,#101216,#181b20 60%,#101216);
			color:var(--text);
			min-height:100dvh;
			display:flex;
			flex-direction:column;
		}
		header {
			padding:1rem clamp(.75rem,2vw,2rem);
			background:#13161aee;
			backdrop-filter: blur(12px) saturate(1.4);
			display:flex;
			flex-wrap:wrap;
			align-items:center;
			gap:1rem 2rem;
			position:sticky;top:0;z-index:10;
			border-bottom:1px solid #23282f;
		}
		header h1 {font-size:1.15rem;margin:0;font-weight:600;letter-spacing:.5px;}
		.controls {display:flex;flex-wrap:wrap;gap:1rem;align-items:center;}
		label {display:flex;flex-direction:column;font-size:.65rem;letter-spacing:1px;text-transform:uppercase;gap:.35rem;font-weight:600;color:var(--muted);}        
		select {appearance:none;-webkit-appearance:none;padding:.7rem .9rem;border:1px solid #2b3139;background:var(--panel);color:var(--text);border-radius:var(--radius);font-size:.9rem;min-width:170px;box-shadow:inset 0 0 0 1px #23282f;}        
		select:focus {outline:2px solid var(--accent);}
		main {width:100%;max-width:1000px;margin:1rem auto 3rem;padding:0 clamp(.75rem,2vw,2rem);flex:1;}
		#imagesContainer {display:flex;flex-direction:column;gap:1.25rem;}
		.page-wrapper {position:relative;background:#0d0f12;border:1px solid #22272e;border-radius:var(--radius);padding: .75rem .75rem 1.15rem;box-shadow:var(--shadow);}
		.page-wrapper.loading {animation:pulse 1.4s ease-in-out infinite;background:linear-gradient(110deg,#1b1f25 10%,#222830 40%,#1b1f25 70%);background-size:200% 100%;}
		@keyframes pulse {to {background-position:-200% 0;}}
		.page-number {position:absolute;top:.35rem;right:.6rem;font-size:.65rem;background:#0008;padding:.25rem .5rem;border-radius:6px;color:var(--muted);}
		img.page {width:100%;height:auto;display:block;border-radius:6px;object-fit:contain;background:#0b0d10;}
		footer {padding:2rem 1rem 3rem;text-align:center;font-size:.75rem;color:var(--muted);}        
		.mode-indicator {font-size:.7rem;letter-spacing:1px;color:var(--muted);text-transform:uppercase;font-weight:600;margin-left:auto;}
		.hidden {display:none !important;}
		.sr-only {position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;}
		.top-btn {position:fixed;bottom:1.2rem;right:1.2rem;background:var(--accent);color:#fff;border:none;border-radius:50%;width:54px;height:54px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;cursor:pointer;box-shadow:0 6px 18px -4px rgba(0,0,0,.6);transition:.25s;}        
		.top-btn:hover {background:var(--accent-hover);transform:translateY(-3px);}        
		@media (min-width:1100px){header{border-radius:0 0 16px 16px;margin:0 auto;} }
	</style>
</head>
<body>
	<header>
		<div class="controls">
			<label>
				Chapter
				<select id="chapterSelect" aria-label="Seleccionar capítulo">
					<option value="CH1" selected>Chapter 1</option>
				</select>
			</label>
			<label>
				Display
				<select id="displayMode" aria-label="Modo de visualización">
					<option value="chapter" selected>Per chapter</option>
					<option value="all">All chapters</option>
				</select>
			</label>
		</div>
	</header>
	<main>
		<div id="imagesContainer" aria-live="polite"></div>
	</main>
	<button class="top-btn" id="backToTop" title="Go Up" aria-label="Go Up">↑</button>

	<script>
	(function(){
		const chapterConfig = {
			CH1: { count: 67, path: 'IMG/COMIC/CH1', pad:false }
		};

		const chapterOrder = ['CH1'];

		const chapterSelect = document.getElementById('chapterSelect');
		const displayMode = document.getElementById('displayMode');
		const container = document.getElementById('imagesContainer');
		const modeIndicator = document.getElementById('modeIndicator');
		const backToTop = document.getElementById('backToTop');

		function buildImageSrc(chKey, index){
			const cfg = chapterConfig[chKey];
			const fileNumber = cfg.pad ? String(index).padStart(2,'0') : index;
			return `${cfg.path}/${fileNumber}.webp`;
		}

		function createPageElement(chKey, index){
			const wrap = document.createElement('div');
			wrap.className = 'page-wrapper loading';
			wrap.dataset.chapter = chKey;
			wrap.dataset.page = index;

			const num = document.createElement('span');
			num.className = 'page-number';
			wrap.appendChild(num);

			const img = document.createElement('img');
			img.loading = 'lazy';
			img.decoding = 'async';
			img.className = 'page';
			img.alt = `Page ${index} of ${chKey}`;
			img.src = buildImageSrc(chKey,index);
			img.addEventListener('load',()=>wrap.classList.remove('loading'));            
			img.addEventListener('error',()=>{wrap.classList.remove('loading');wrap.classList.add('error');num.textContent += ' (error)';});
			wrap.appendChild(img);
			return wrap;
		}

		function clearContainer(){
			container.textContent='';
		}

		function renderChapter(chKey){
			const cfg = chapterConfig[chKey];
			for(let i=1;i<=cfg.count;i++){
				container.appendChild(createPageElement(chKey,i));
			}
		}

		function renderAllChapters(){
			chapterOrder.forEach(ch => renderChapter(ch));
		}

		function render(){
			clearContainer();
			if(displayMode.value==='chapter'){
				renderChapter(chapterSelect.value);
			} else {
				renderAllChapters();
			}
		}

		displayMode.addEventListener('change', render);
		backToTop.addEventListener('click',()=>window.scrollTo({top:0,behavior:'smooth'}));

		// Keyboard quick-jump: j next page, k prev page (within visible set)
		document.addEventListener('keydown', e => {
			if(['INPUT','SELECT','TEXTAREA'].includes(document.activeElement.tagName)) return;
			const pages = [...container.querySelectorAll('.page-wrapper')];
			if(!pages.length) return;
			const viewportCenter = window.scrollY + window.innerHeight/2;
			let currentIndex = pages.findIndex(p=>{
				const r = p.getBoundingClientRect();
				const top = r.top + window.scrollY;
				const bottom = top + r.height;
				return viewportCenter>=top && viewportCenter<=bottom;
			});
			if(e.key==='j'){ // next
				const target = pages[Math.min(pages.length-1, currentIndex+1)];
				if(target) target.scrollIntoView({behavior:'smooth',block:'start'});
			} else if(e.key==='k'){ // prev
				const target = pages[Math.max(0, currentIndex-1)];
				if(target) target.scrollIntoView({behavior:'smooth',block:'start'});
			}
		});

		// Initial render
		render();
	})();
	</script>
</body>
</html>
